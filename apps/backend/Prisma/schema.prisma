datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   PATIENT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Patient {
  id             Int       @id @default(autoincrement())
  nom            String
  prenom         String
  email          String    @unique
  motDePasse     String
  telephone      String?
  resetToken     String?
  resetExpires   DateTime?
  adresse        String?
  anneeNaissance Int?

  // Relation avec mÃ©decin traitant
  medecinTraitantId Int?
  medecinTraitant   Medecin? @relation("MedecinTraitant", fields: [medecinTraitantId], references: [id])

  // Relation avec les rendez-vous
  rdvs RendezVous[] @relation("PatientRdv")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   CABINET (NOUVEAU)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Cabinet {
  id        Int      @id @default(autoincrement())
  nom       String
  adresse   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relation cabinet â†’ mÃ©decins
  medecins Medecin[]
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   MEDECIN
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Medecin {
  id         Int     @id @default(autoincrement())
  nom        String
  prenom     String
  email      String  @unique
  motDePasse String?
  telephone  String?
  specialite String?

  // Nouvelle info cabinet / identitÃ©
  adresseCabinet String?
  rpps           String?

  // Permettre nouveaux patients
  accepteNouveauxPatients Boolean @default(true)

  // ðŸ”¥ Ajouts 1 â†’ 6
  statut             String  @default("en_attente")
  photoUrl           String?
  horaires           Json?
  bio                String?
  typeExercice       String?
  siret              String?
  adresseFacturation String?

  // Cabinet (relation)
  cabinetId Int?
  cabinet   Cabinet? @relation(fields: [cabinetId], references: [id])

  // Relations patients / rdv
  patientsTraitant Patient[]    @relation("MedecinTraitant")
  rdvs             RendezVous[] @relation("MedecinRdv")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   RENDEZVOUS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model RendezVous {
  id     Int      @id @default(autoincrement())
  date   DateTime
  heure  String
  motif  String?
  statut String   @default("confirmÃ©")

  // Relations
  patientId Int?
  medecinId Int?

  patient Patient? @relation("PatientRdv", fields: [patientId], references: [id])
  medecin Medecin? @relation("MedecinRdv", fields: [medecinId], references: [id])
}
